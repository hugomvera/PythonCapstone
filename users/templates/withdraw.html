{%extends 'base.html'%} {% block content %}
<body onload="loadData('name'); loadData('balance')">
	<h2>Withdraw from Account</h2>

	<div class="row">
		<div class="col">
			<div class="card" style="width: 18rem">
				<div class="card-body">
					<h5 class="card-title" id="name"></h5>
					<p class="card-text" id="balance"></p>
					<a href="#" class="btn btn-primary" onclick="withdrawX(1)"
						>Withdraw $1</a
					>
				</div>
			</div>
			<p></p>
		</div>
	</div>
	<form action="" method="post">
		{% csrf_token %} {{ form.as_p }}
		<input type="submit" value="Submit" />
	</form>
	<script>
		var balance = -1;
		function loadData(key) {
			if (key == "name") {
				document.getElementById("name").innerHTML =
					sessionStorage.getItem(key) + "'s Balance";
			} else if (key == "balance") {
				balance = sessionStorage.getItem(key);
				balance = balance.replace("$", "");
				balance = parseInt(balance);
				document.getElementById("balance").innerHTML = "$" + balance;
			}
		}
		function withdrawX(X) {
			balance -= X;
			document.getElementById("balance").innerHTML = "$" + balance;
		}

		function updateData() {
			$(".ajaxProgress").show();
			$.ajax({
				type: "POST",
				data: {
					csrfmiddlewaretoken: "{{csrf_token}}",
					newbalance: $("#balance").val(),
				},
			});
		}
	</script>
	<a href="{% url 'home' %}">Back to Home</a>
	{% endblock %}
</body>
